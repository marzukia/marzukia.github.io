<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="UTF-8">
    <title>Andryo Marzuki</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="description" content="Using your browser and Python to map out an undocumented API quickly" />

    <meta property="og:title" content="Mapping an Undocumented API Easily With Python" />
    <meta property="og:description" content="Using your browser and Python to map out an undocumented API quickly" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://marzukia.github.io/mapping-an-undocumented-api/" />
    <meta itemprop="name" content="Mapping an Undocumented API Easily With Python">
    <meta itemprop="description" content="Using your browser and Python to map out an undocumented API quickly">
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:title" content="Mapping an Undocumented API Easily With Python"/>
    <meta name="twitter:description" content="Using your browser and Python to map out an undocumented API quickly"/>

    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon.ico">

    
    <link rel="stylesheet" href="https://marzukia.github.io/scss/style.min.1fe217279238c86cc8ea6d780fe485a00ed7c74ffe4d1bc0f583d8468be982cd.css" >

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-170171726-1"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-170171726-1');
    </script>
</head>
<body><header>
    <div class="site-title">
        <a href='https://marzukia.github.io/' alt=Andryo&#32;Marzuki>
            <svg
   width="132.29166mm"
   height="38.646618mm"
   viewBox="0 0 132.29166 38.646618"
   version="1.1"
   id="svg1587"
   inkscape:version="1.1 (c68e22c387, 2021-05-23)"
   sodipodi:docname="logo.svg"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg">
  <sodipodi:namedview
     id="namedview1589"
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1.0"
     inkscape:pageshadow="2"
     inkscape:pageopacity="0.0"
     inkscape:pagecheckerboard="0"
     inkscape:document-units="px"
     showgrid="false"
     inkscape:zoom="0.74457511"
     inkscape:cx="181.98298"
     inkscape:cy="445.89189"
     inkscape:window-width="2560"
     inkscape:window-height="1371"
     inkscape:window-x="0"
     inkscape:window-y="1472"
     inkscape:window-maximized="1"
     inkscape:current-layer="g207463"
     fit-margin-top="0"
     fit-margin-left="0"
     fit-margin-right="0"
     fit-margin-bottom="0" />
  <defs
     id="defs1584" />
  <g
     inkscape:label="Layer 1"
     inkscape:groupmode="layer"
     id="layer1"
     transform="translate(-23.968996,-50.153165)">
    <g
       id="g207463"
       transform="matrix(2.562842,0,0,2.562842,-70.880235,-128.18872)"
       style="stroke-width:0.390192">
      <g
         id="g207867"
         inkscape:export-filename="/home/andryo/logo.png"
         inkscape:export-xdpi="43.77"
         inkscape:export-ydpi="43.77"
         transform="matrix(1.1398749,0,0,1.1398749,-10.098017,-24.674857)">
        <g
           id="g2462-3-6"
           transform="matrix(2.0550572,0,0,2.0536728,-134.02958,-51.534253)"
           style="display:inline;stroke-width:0.189211;paint-order:fill markers stroke"
           inkscape:label="g2462-3">
          <g
             id="g164836"
             transform="translate(0.81892291)"
             style="stroke-width:0.189211">
            <g
               id="g207355"
               transform="matrix(0.60585854,0,0,0.60650002,35.548546,25.477297)"
               style="stroke-width:0.312136">
              <path
                 style="color:#000000;fill:#ef6f6c;fill-opacity:1;stroke:#ef6f6c;stroke-width:0.331606;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
                 d="m 83.991949,65.972596 c -0.229761,0.0011 -0.458941,0.0294 -0.68164,0.08594 l -0.195313,0.05078 1.367188,5.466797 0.197265,-0.04883 c 0.521891,-0.130541 0.979302,-0.402051 1.335581,-0.767772 0.499445,-0.512683 0.800149,-1.210504 0.801138,-1.96465 4.62e-4,-1.55648 -1.265785,-2.822728 -2.822266,-2.822266 z m 0.002,0.404297 c 1.337386,-3.97e-4 2.416413,1.080584 2.416016,2.417969 -0.0014,1.0328 -0.691302,1.886109 -1.650391,2.222656 L 83.61309,66.425721 c 0.126818,-0.02102 0.252095,-0.04823 0.380859,-0.04883 z"
                 id="path1361-7-9"
                 sodipodi:nodetypes="sccccscssscccss" />
              <path
                 style="color:#000000;fill:#c8c8c8;fill-opacity:1;stroke:#c8c8c8;stroke-width:0.165803;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
                 d="m 83.34375,72.017578 -0.792969,0.265625 -0.730469,-0.244141 -0.128906,0.384766 0.859375,0.285156 0.792969,-0.263672 0.792969,0.263672 0.859375,-0.285156 -0.128907,-0.384766 -0.730468,0.244141 z"
                 id="path2248-5-1" />
              <g
                 id="path3324-6-2"
                 inkscape:label="Mountain"
                 transform="matrix(0.16906935,0,0,0.16906935,30.83561,25.481525)"
                 style="stroke-width:0.312136">
                <path
                   style="color:#000000;fill:#000000;fill-opacity:0;stroke-width:0.976951;-inkscape-stroke:none"
                   d="m 297.95901,289.80307 12.44018,-49.76071 14.86693,59.46772 14.86693,-59.46772 12.44308,49.77227"
                   id="path11216" />
                <path
                   style="color:#000000;fill:#477160;fill-opacity:1;stroke:#477160;stroke-width:1.96136;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
                   d="m 309.23633,239.75195 -12.43946,49.75977 2.32422,0.58203 11.27735,-45.10742 13.70508,54.81445 h 2.32617 l 13.70312,-54.81836 11.28125,45.12305 2.32422,-0.58203 -12.44336,-49.77149 h -2.32422 l -13.70508,54.81446 -13.70312,-54.81446 z"
                   id="path11218" />
              </g>
            </g>
          </g>
        </g>
        <g
           id="g82068"
           transform="matrix(1.5511182,0,0,1.5511182,-73.685773,-19.254697)"
           style="stroke-width:0.251556">
          <g
             id="g97616"
             transform="translate(0.30734772,0.02438643)"
             style="stroke-width:0.251556">
            <text
               xml:space="preserve"
               style="font-size:5.29167px;line-height:1.25;font-family:'Droid Sans';-inkscape-font-specification:'Droid Sans';letter-spacing:-0.396875px;fill:#646464;fill-opacity:1;stroke-width:0.0665574"
               x="82.43605"
               y="69.722878"
               id="text22981"><tspan
                 sodipodi:role="line"
                 id="tspan22979"
                 style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:5.29167px;font-family:monospace;-inkscape-font-specification:monospace;fill:#646464;fill-opacity:1;stroke-width:0.0665574"
                 x="82.43605"
                 y="69.722878">andryo</tspan></text>
            <text
               xml:space="preserve"
               style="font-size:5.29167px;line-height:1.25;font-family:'Droid Sans';-inkscape-font-specification:'Droid Sans';letter-spacing:-0.264583px;stroke-width:0.0665574"
               x="82.498062"
               y="74.156311"
               id="text22981-3"><tspan
                 sodipodi:role="line"
                 id="tspan22979-6"
                 style="font-style:normal;font-variant:normal;font-weight:bold;font-stretch:normal;font-size:5.29167px;font-family:monospace;-inkscape-font-specification:monospace;fill:#ef6f6c;fill-opacity:1;stroke-width:0.0665574"
                 x="82.498062"
                 y="74.156311">marzuki</tspan></text>
          </g>
        </g>
      </g>
    </g>
  </g>
</svg>

        </a>
    </div>
    <div class="socials">




<a
  href="https://instagram.com/andryo"
  target="_blank"
  class="social-link"
  title="Instagram link"
  rel="noopener"
  aria-label="follow on Instagram——Opens in a new window"
>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M14.667 12c0 1.473-1.194 2.667-2.667 2.667-1.473 0-2.667-1.193-2.667-2.667 0-1.473 1.194-2.667 2.667-2.667 1.473 0 2.667 1.194 2.667 2.667zm3.846-3.232c.038.843.046 1.096.046 3.232s-.008 2.389-.046 3.233c-.1 2.15-1.109 3.181-3.279 3.279-.844.038-1.097.047-3.234.047-2.136 0-2.39-.008-3.232-.046-2.174-.099-3.181-1.132-3.279-3.279-.039-.845-.048-1.098-.048-3.234s.009-2.389.047-3.232c.099-2.152 1.109-3.181 3.279-3.279.844-.039 1.097-.047 3.233-.047s2.39.008 3.233.046c2.168.099 3.18 1.128 3.28 3.28zm-2.405 3.232c0-2.269-1.84-4.108-4.108-4.108-2.269 0-4.108 1.839-4.108 4.108 0 2.269 1.84 4.108 4.108 4.108 2.269 0 4.108-1.839 4.108-4.108zm1.122-4.27c0-.53-.43-.96-.96-.96s-.96.43-.96.96.43.96.96.96c.531 0 .96-.43.96-.96zm6.77-7.73v24h-24v-24h24zm-4 12c0-2.172-.009-2.445-.048-3.298-.131-2.902-1.745-4.52-4.653-4.653-.854-.04-1.126-.049-3.299-.049s-2.444.009-3.298.048c-2.906.133-4.52 1.745-4.654 4.653-.039.854-.048 1.127-.048 3.299 0 2.173.009 2.445.048 3.298.134 2.906 1.746 4.521 4.654 4.654.854.039 1.125.048 3.298.048s2.445-.009 3.299-.048c2.902-.133 4.522-1.745 4.653-4.654.039-.853.048-1.125.048-3.298z"/></svg>
</a>



<a
  href="https://linkedin.com/in/andryomarzuki"
  target="_blank"
  class="social-link"
  title="LinkedIn link"
  rel="noopener"
  aria-label="follow on LinkedIn——Opens in a new window"
>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 0v24h24v-24h-24zm8 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.397-2.586 7-2.777 7 2.476v6.759z"/></svg>
</a>


<a
  href="https://github.com/marzukia"
  target="_blank"
  class="social-link"
  title="Github link"
  rel="noopener"
  aria-label="follow on Github——Opens in a new window"
>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 0v24h24v-24h-24zm14.534 19.59c-.406.078-.534-.171-.534-.384v-2.195c0-.747-.262-1.233-.55-1.481 1.782-.198 3.654-.875 3.654-3.947 0-.874-.311-1.588-.824-2.147.083-.202.357-1.016-.079-2.117 0 0-.671-.215-2.198.82-.639-.18-1.323-.267-2.003-.271-.68.003-1.364.091-2.003.269-1.528-1.035-2.2-.82-2.2-.82-.434 1.102-.16 1.915-.077 2.118-.512.56-.824 1.273-.824 2.147 0 3.064 1.867 3.751 3.645 3.954-.229.2-.436.552-.508 1.07-.457.204-1.614.557-2.328-.666 0 0-.423-.768-1.227-.825 0 0-.78-.01-.055.487 0 0 .525.246.889 1.17 0 0 .463 1.428 2.688.944v1.489c0 .211-.129.459-.528.385-3.18-1.057-5.472-4.056-5.472-7.59 0-4.419 3.582-8 8-8s8 3.581 8 8c0 3.533-2.289 6.531-5.466 7.59z"/></svg>
</a>




</div>
</header>
<div class="post">
    <h1>Mapping an Undocumented API Easily With Python</h1>
    <div class="post-content">
        <p>I was working on an NBA related project the other week and I had decided I wanted to create my own API wrapper (for fun) as part of the project.</p>
<p>The primary source of data I was looking to use was the <a href="stats.nba.com">stats.nba.com</a> API, our biggest challenge in using this endpoint is the fact they do not want to use it. Let&rsquo;s breakdown the issues we face:</p>
<ol>
<li>They block calls of any suspicious activity very liberally</li>
<li>The API is undocumented</li>
<li>The API constantly changes</li>
</ol>
<p>I&rsquo;ve done different projects on this API in the past with has aimed to address some of these challenges such as <a href="https://github.com/marzukia/aionba">aionba</a>, which incorporated asynchronous calls with rotating proxies and caching to avoid the chances of being blocked. This project was ultimately unfinished as it ended up being more reliable just to call the API slowly.</p>
<p>This post will talk about the second challenge, the fact that the API is undocumented. Whilst you could rely on other people&rsquo;s lists that they have compiled, it&rsquo;s often nice to be able to this on your own. I&rsquo;ll breakdown the method I came up with this particular instance as it was a snap to do, and gave me a pretty comprehensive list to use for development purposes.</p>
<p>If you came here solely for the endpoints, you can find it <a href="https://github.com/marzukia/nba/wiki">here</a>.</p>
<h2 id="tooling">Tooling</h2>
<p>For this method, you&rsquo;ll need some basic familiarity with working with JSON data. We&rsquo;ll be taking advantage of <code>HAR</code> data collected by Firefox (or similar) and using Python (you can use what you&rsquo;re most comfortable with) to unpack this data and generate markdown documentation for our project.</p>
<p>I use Firefox as my primary browser, however, I assume whatever browser you use will suffice provided it is a modern one.</p>
<p>JavaScript or C# would probably work fine here too, in general, I use Python for quick and dirty projects where speed/performance is not a priority.</p>
<h2 id="method">Method</h2>
<p>There is a manual element in this process, and without significant effort to automate it, it&rsquo;s probably unavoidable. If you intend to do this regularly to make sure your documentation is up to date, you could do this portion with macros or something like Selenium. In this case, I&rsquo;ll be doing this as a one-off so I&rsquo;ve done it manually.</p>
<h3 id="collecting-har-data">Collecting HAR Data</h3>
<blockquote>
<p><strong>Note</strong>: Make sure you tick &lsquo;Persist Logs&rsquo;.</p>
</blockquote>
<p>For this step, you&rsquo;ll want to systematically go through every visible page on the available to you, and apply each filter possible. The purpose of this is that the code you&rsquo;ll write will summarise this data into &lsquo;valid&rsquo; parameters and options for the various endpoints. This part is very tedious but it does not take that long.</p>
<p>You&rsquo;ll notice very quickly that <a href="stats.nba.com">stats.nba.com</a> throttles the majority of your requests. This highlights how badly they don&rsquo;t want people using their data, to the point where they hamstring their user experience.</p>
<p>Once you&rsquo;ve gone through the different pages and filters, simply save your <code>HAR</code> data from the network tab of your developer tools.</p>
<h3 id="analysing-the-har-data">Analysing the HAR Data</h3>
<p>This step is the interesting part, as you&rsquo;ll be able to quickly see commonalities in the endpoint and how it&rsquo;s used. In particular, common properties and their payloads are evident.</p>
<p>In the below example, you&rsquo;ll note that I&rsquo;ve specified <code>predefined</code> values of which I know their values. This is due to my laziness in wanting to minimize the amount of manual work in the previous step - as I know these values are essentially static, I did not bother changing their filter values.</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#f92672">import</span> <span style="color:#111">json</span>
<span style="color:#f92672">import</span> <span style="color:#111">os</span>
<span style="color:#f92672">from</span> <span style="color:#111">collections</span> <span style="color:#f92672">import</span> <span style="color:#111">defaultdict</span>
<span style="color:#f92672">from</span> <span style="color:#111">urllib.parse</span> <span style="color:#f92672">import</span> <span style="color:#111">urlparse</span><span style="color:#111">,</span> <span style="color:#111">parse_qs</span>
<span style="color:#f92672">import</span> <span style="color:#111">strconv</span>

<span style="color:#111">urls</span> <span style="color:#f92672">=</span> <span style="color:#111">[]</span>
<span style="color:#111">folder</span> <span style="color:#f92672">=</span> <span style="color:#d88200">&#39;har/&#39;</span>
<span style="color:#111">base_url</span> <span style="color:#f92672">=</span> <span style="color:#d88200">&#34;https://stats.nba.com/stats/&#34;</span>

<span style="color:#00a8c8">for</span> <span style="color:#111">filepath</span> <span style="color:#f92672">in</span> <span style="color:#111">os</span><span style="color:#f92672">.</span><span style="color:#111">listdir</span><span style="color:#111">(</span><span style="color:#111">folder</span><span style="color:#111">):</span>
    <span style="color:#111">f</span> <span style="color:#f92672">=</span> <span style="color:#111">open</span><span style="color:#111">(</span><span style="color:#111">folder</span> <span style="color:#f92672">+</span> <span style="color:#111">filepath</span><span style="color:#111">)</span>
    <span style="color:#111">data</span> <span style="color:#f92672">=</span> <span style="color:#111">json</span><span style="color:#f92672">.</span><span style="color:#111">load</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#111">)</span>
    <span style="color:#111">data</span> <span style="color:#f92672">=</span> <span style="color:#111">data</span><span style="color:#f92672">.</span><span style="color:#111">get</span><span style="color:#111">(</span><span style="color:#d88200">&#39;log&#39;</span><span style="color:#111">)</span>
    <span style="color:#00a8c8">for</span> <span style="color:#111">entry</span> <span style="color:#f92672">in</span> <span style="color:#111">data</span><span style="color:#111">[</span><span style="color:#d88200">&#39;entries&#39;</span><span style="color:#111">]:</span>
        <span style="color:#111">urls</span><span style="color:#f92672">.</span><span style="color:#111">append</span><span style="color:#111">(</span><span style="color:#111">entry</span><span style="color:#111">[</span><span style="color:#d88200">&#39;request&#39;</span><span style="color:#111">][</span><span style="color:#d88200">&#39;url&#39;</span><span style="color:#111">])</span>

<span style="color:#111">endpoint_map</span> <span style="color:#f92672">=</span> <span style="color:#111">defaultdict</span><span style="color:#111">(</span><span style="color:#00a8c8">lambda</span><span style="color:#111">:</span> <span style="color:#111">defaultdict</span><span style="color:#111">(</span><span style="color:#111">list</span><span style="color:#111">))</span>
<span style="color:#111">predefined</span> <span style="color:#f92672">=</span> <span style="color:#111">{</span>
    <span style="color:#d88200">&#34;LastNGames&#34;</span><span style="color:#111">:</span> <span style="color:#111">set</span><span style="color:#111">([</span><span style="color:#ae81ff">8</span><span style="color:#111">,</span> <span style="color:#ae81ff">11</span><span style="color:#111">,</span> <span style="color:#ae81ff">2</span><span style="color:#111">,</span> <span style="color:#ae81ff">6</span><span style="color:#111">,</span> <span style="color:#ae81ff">5</span><span style="color:#111">,</span> <span style="color:#ae81ff">7</span><span style="color:#111">,</span> <span style="color:#ae81ff">12</span><span style="color:#111">,</span> <span style="color:#ae81ff">14</span><span style="color:#111">,</span> <span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#ae81ff">3</span><span style="color:#111">,</span> <span style="color:#ae81ff">1</span><span style="color:#111">,</span> <span style="color:#ae81ff">9</span><span style="color:#111">,</span> <span style="color:#ae81ff">4</span><span style="color:#111">,</span> <span style="color:#ae81ff">13</span><span style="color:#111">]),</span>
    <span style="color:#d88200">&#34;Month&#34;</span><span style="color:#111">:</span> <span style="color:#111">set</span><span style="color:#111">([</span><span style="color:#ae81ff">8</span><span style="color:#111">,</span> <span style="color:#ae81ff">11</span><span style="color:#111">,</span> <span style="color:#ae81ff">2</span><span style="color:#111">,</span> <span style="color:#ae81ff">6</span><span style="color:#111">,</span> <span style="color:#ae81ff">5</span><span style="color:#111">,</span> <span style="color:#ae81ff">7</span><span style="color:#111">,</span> <span style="color:#ae81ff">12</span><span style="color:#111">,</span> <span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#ae81ff">1</span><span style="color:#111">,</span> <span style="color:#ae81ff">9</span><span style="color:#111">,</span> <span style="color:#ae81ff">4</span><span style="color:#111">]),</span>
    <span style="color:#d88200">&#34;SeasonSegment&#34;</span><span style="color:#111">:</span> <span style="color:#111">set</span><span style="color:#111">([</span><span style="color:#d88200">&#39;Post All-Star&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;Pre All-Star&#39;</span><span style="color:#111">]),</span>
    <span style="color:#d88200">&#34;SeasonType&#34;</span><span style="color:#111">:</span> <span style="color:#111">set</span><span style="color:#111">([</span><span style="color:#d88200">&#39;Regular Season&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;All Star&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;Playoffs&#39;</span><span style="color:#111">])</span>
<span style="color:#111">}</span>

<span style="color:#00a8c8">for</span> <span style="color:#111">url</span> <span style="color:#f92672">in</span> <span style="color:#111">urls</span><span style="color:#111">:</span>
    <span style="color:#00a8c8">if</span> <span style="color:#d88200">&#34;?&#34;</span> <span style="color:#f92672">in</span> <span style="color:#111">url</span><span style="color:#111">:</span>
        <span style="color:#111">endpoint</span> <span style="color:#f92672">=</span> <span style="color:#111">url</span><span style="color:#f92672">.</span><span style="color:#111">split</span><span style="color:#111">(</span><span style="color:#d88200">&#39;?&#39;</span><span style="color:#111">)[</span><span style="color:#ae81ff">0</span><span style="color:#111">]</span>
        <span style="color:#111">endpoint</span> <span style="color:#f92672">=</span> <span style="color:#111">endpoint</span><span style="color:#f92672">.</span><span style="color:#111">split</span><span style="color:#111">(</span><span style="color:#111">base_url</span><span style="color:#111">)[</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#111">]</span>
        <span style="color:#111">params</span> <span style="color:#f92672">=</span> <span style="color:#111">parse_qs</span><span style="color:#111">(</span><span style="color:#111">urlparse</span><span style="color:#111">(</span><span style="color:#111">url</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">query</span><span style="color:#111">)</span>

        <span style="color:#00a8c8">for</span> <span style="color:#111">key</span><span style="color:#111">,</span> <span style="color:#111">value</span> <span style="color:#f92672">in</span> <span style="color:#111">params</span><span style="color:#f92672">.</span><span style="color:#111">items</span><span style="color:#111">():</span>
            <span style="color:#111">endpoint_map</span><span style="color:#111">[</span><span style="color:#111">endpoint</span><span style="color:#111">][</span><span style="color:#111">key</span><span style="color:#111">]</span> <span style="color:#f92672">+=</span> <span style="color:#111">value</span>

<span style="color:#00a8c8">for</span> <span style="color:#111">endpoint</span> <span style="color:#f92672">in</span> <span style="color:#111">endpoint_map</span><span style="color:#111">:</span>
    <span style="color:#00a8c8">for</span> <span style="color:#111">key</span><span style="color:#111">,</span> <span style="color:#111">value</span> <span style="color:#f92672">in</span> <span style="color:#111">endpoint_map</span><span style="color:#111">[</span><span style="color:#111">endpoint</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">items</span><span style="color:#111">():</span>
        <span style="color:#00a8c8">if</span> <span style="color:#111">key</span> <span style="color:#f92672">in</span> <span style="color:#111">predefined</span><span style="color:#111">:</span>
            <span style="color:#111">endpoint_map</span><span style="color:#111">[</span><span style="color:#111">endpoint</span><span style="color:#111">][</span><span style="color:#111">key</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">predefined</span><span style="color:#111">[</span><span style="color:#111">key</span><span style="color:#111">]</span>
        <span style="color:#00a8c8">else</span><span style="color:#111">:</span>
            <span style="color:#111">endpoint_map</span><span style="color:#111">[</span><span style="color:#111">endpoint</span><span style="color:#111">][</span><span style="color:#111">key</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">set</span><span style="color:#111">(</span><span style="color:#111">value</span><span style="color:#111">)</span>
</code></pre></div><p>The steps above breakdown as follows:</p>
<ol>
<li>Load the <code>HAR</code> file as a <code>JSON</code>.</li>
<li>Grab the relevant data within the logs.</li>
<li>Use a basic <code>for</code> loop to tidy the data and summarise it.</li>
</ol>
<h3 id="making-our-documentation">Making our Documentation</h3>
<p>Once our data is nicely organised and structured, we can quickly make some nice documentation.</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#111">f</span> <span style="color:#f92672">=</span> <span style="color:#111">open</span><span style="color:#111">(</span><span style="color:#d88200">&#39;output.md&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#34;w&#34;</span><span style="color:#111">)</span>

<span style="color:#111">f</span><span style="color:#f92672">.</span><span style="color:#111">write</span><span style="color:#111">(</span><span style="color:#d88200">&#39;# stats.nba.com Endpoints</span><span style="color:#8045ff">\n</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>

<span style="color:#111">f</span><span style="color:#f92672">.</span><span style="color:#111">write</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200">&#39;This document was autogenerated on `{ str(datetime.datetime.utcnow()) }`, the below endpoints are valid to the best of my knowledge at time of creation. </span><span style="color:#8045ff">\n</span><span style="color:#d88200"> </span><span style="color:#8045ff">\n</span><span style="color:#d88200"> This document was prepared for educational purposes only, it should not be used for commercial use. </span><span style="color:#8045ff">\n</span><span style="color:#d88200"> </span><span style="color:#8045ff">\n</span><span style="color:#d88200"> __Note__: type inferences may not be correct, use this as a reference rather than a guide. </span><span style="color:#8045ff">\n</span><span style="color:#d88200"> </span><span style="color:#8045ff">\n</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>

<span style="color:#00a8c8">for</span> <span style="color:#111">endpoint</span><span style="color:#111">,</span> <span style="color:#111">params</span> <span style="color:#f92672">in</span> <span style="color:#111">endpoint_map</span><span style="color:#f92672">.</span><span style="color:#111">items</span><span style="color:#111">():</span>
    <span style="color:#111">f</span><span style="color:#f92672">.</span><span style="color:#111">write</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200">&#39;</span><span style="color:#8045ff">\n</span><span style="color:#d88200">## `{endpoint}`</span><span style="color:#8045ff">\n\n</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
    <span style="color:#111">f</span><span style="color:#f92672">.</span><span style="color:#111">write</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200">&#39;### Parameters </span><span style="color:#8045ff">\n\n</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>

    <span style="color:#00a8c8">for</span> <span style="color:#111">key</span><span style="color:#111">,</span> <span style="color:#111">values</span> <span style="color:#f92672">in</span> <span style="color:#111">params</span><span style="color:#f92672">.</span><span style="color:#111">items</span><span style="color:#111">():</span>
        <span style="color:#111">inferred_type</span> <span style="color:#f92672">=</span> <span style="color:#111">None</span>
        <span style="color:#00a8c8">if</span> <span style="color:#111">len</span><span style="color:#111">(</span><span style="color:#111">values</span><span style="color:#111">)</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span><span style="color:#111">:</span>
            <span style="color:#111">_</span> <span style="color:#f92672">=</span> <span style="color:#111">[</span><span style="color:#111">i</span> <span style="color:#00a8c8">for</span> <span style="color:#111">i</span> <span style="color:#f92672">in</span> <span style="color:#111">list</span><span style="color:#111">(</span><span style="color:#111">values</span><span style="color:#111">)]</span>
            <span style="color:#111">inferred_type</span> <span style="color:#f92672">=</span> <span style="color:#111">set</span><span style="color:#111">([</span><span style="color:#111">strconv</span><span style="color:#f92672">.</span><span style="color:#111">infer</span><span style="color:#111">(</span><span style="color:#111">i</span><span style="color:#111">)</span> <span style="color:#00a8c8">if</span> <span style="color:#111">strconv</span><span style="color:#f92672">.</span><span style="color:#111">infer</span><span style="color:#111">(</span><span style="color:#111">i</span><span style="color:#111">)</span> <span style="color:#00a8c8">else</span> <span style="color:#d88200">&#39;str&#39;</span> <span style="color:#00a8c8">for</span> <span style="color:#111">i</span> <span style="color:#f92672">in</span> <span style="color:#111">_</span><span style="color:#111">])</span>
            <span style="color:#111">inferred_type</span> <span style="color:#f92672">=</span> <span style="color:#d88200">&#34; ,&#34;</span><span style="color:#f92672">.</span><span style="color:#111">join</span><span style="color:#111">([</span><span style="color:#111">f</span><span style="color:#d88200">&#39;`{i}`&#39;</span> <span style="color:#00a8c8">for</span> <span style="color:#111">i</span> <span style="color:#f92672">in</span> <span style="color:#111">inferred_type</span><span style="color:#111">])</span>


        <span style="color:#111">f</span><span style="color:#f92672">.</span><span style="color:#111">write</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200">&#39;* __{key}__:</span><span style="color:#8045ff">\n</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
        <span style="color:#111">f</span><span style="color:#f92672">.</span><span style="color:#111">write</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200">&#39;  * Inferred Type: { inferred_type } </span><span style="color:#8045ff">\n</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
        <span style="color:#111">f</span><span style="color:#f92672">.</span><span style="color:#111">write</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200">&#39;  * Valid Values: { &#34;, &#34;.join([f&#34;`{v}`&#34; for v in values]) }</span><span style="color:#8045ff">\n</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>

</code></pre></div><p>The above code snippet writes each line of our data into a <code>md</code> document. <em>Easy</em>.</p>
<p>You can see the results <a href="https://github.com/marzukia/nba/blob/master/api_documentation.md">here</a>.</p>
<h2 id="closing-thoughts">Closing Thoughts</h2>
<p>Next time you&rsquo;re wanting to work with a non-public friendly API, give this method a try. I&rsquo;ll likely follow up on this post in the future as to my approach to making an API wrapper and how I would automate the process done in this article.</p>

    </div>
</div>
<footer>
    © 2019-2021, Andryo Marzuki
</footer>
</body>
</html>
